 <!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ICD Cost Estimator‚Ñ¢</title>

  <!-- Meta -->
  <meta name="description" content="Planning-level budgeting tool for Insulated Concrete Domes (ICD). All client-side; no data leaves your browser." />
  <meta name="theme-color" content="#001f3f" />

  <!-- Styles -->
  <link rel="stylesheet" href="./icdce.css" />
  <style>
    /* Sticky action bar */
    #icdce ._stickybar{
      position:sticky; bottom:0; z-index:50; inset-inline:0;
      display:flex; gap:10px; justify-content:space-between; align-items:center;
      padding:10px 12px; background:rgba(255,255,255,.96); backdrop-filter:saturate(1.2) blur(6px);
      border-top:1px solid var(--border-color);
    }
    #icdce ._stickybar ._btn{ flex:1 1 auto; }
    #icdce ._stickybar ._btn._good._unlocked{
      box-shadow:0 0 0 2px rgba(52,168,83,.35) inset;
    }

    /* Unlock toast */
    #icdce #icdce_unlocked{
      position:fixed; left:50%; transform:translateX(-50%) translateY(10px);
      top:10px; z-index:60; padding:10px 14px; border-radius:999px;
      background:#ecfdf5; color:#065f46; border:1px solid #a7f3d0;
      font:500 14px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      display:none; align-items:center; gap:10px; box-shadow:0 10px 20px rgba(0,0,0,.08);
    }
    #icdce #icdce_unlocked._show{ display:flex; animation: slideDown .35s ease-out; }
    @keyframes slideDown{
      from{ transform:translateX(-50%) translateY(-14px); opacity:0; }
      to{ transform:translateX(-50%) translateY(10px); opacity:1; }
    }
  </style>
</head>
<body>
  <div id="icdce">
    <!-- Unlock toast -->
    <div id="icdce_unlocked" aria-live="polite" role="status">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M20 6L9 17l-5-5" stroke="#065f46" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      PDF export unlocked ‚Äî tap ‚ÄúExport PDF‚Äù.
    </div>

    <div class="_wrap">
      <!-- Brand bar -->
      <div class="_brandbar _wrap-mobile">
        <div class="_brandleft _wrap-mobile">
          <div class="_mark">ICD Cost Estimator<span>‚Ñ¢</span></div>
          <div class="_tagline">Planning-level budgeting for Insulated Concrete Domes</div>
        </div>
        <span class="_pill">Client-side ‚Ä¢ No data leaves your browser</span>
      </div>

      <div class="_panel" role="region" aria-label="ICD Cost Estimator">
        <!-- Project Basics -->
        <!-- ... [KEEPING YOUR FULL FORM + SECTIONS AS BEFORE, unchanged] ... -->

        <!-- Results -->
        <div class="_results-pad">
          <div class="_cards">
            <div class="_card">
              <h3>Estimated Range</h3>
              <div class="_big" id="ce_rangeTotal">$0 ‚Äì $0</div>
              <div class="_small" id="ce_rangePerSf">$/SF: $0 ‚Äì $0</div>
            </div>
            <div class="_card">
              <h3>Base Dome Shell (Airform, Foam, Rebar, Shotcrete)</h3>
              <div class="_big" id="ce_baseTotal">$0</div>
              <div class="_small" id="ce_basePsf">$/SF: $0</div>
            </div>
            <div class="_card">
              <h3>Sitework &amp; Rough Grading</h3>
              <div class="_big" id="ce_siteworkTotal">$0 ‚Äì $0</div>
              <div class="_small" id="ce_siteworkNote">Included</div>
            </div>
            <div class="_card" style="grid-column:1 / -1;">
              <h3>Assumptions</h3>
              <div class="_small" id="ce_assumptions">Region 1.00 ‚Ä¢ Standard finish ‚Ä¢ Typical glazing ‚Ä¢ Single dome</div>
            </div>
          </div>

          <h3 class="_results-title">Line-Item Breakdown</h3>
          <p style="font-size:12px;color:#6b7280;margin-bottom:6px;">
            üì± Tip: On mobile devices, rotate your phone to landscape for best viewing of this table.
          </p>
          <div class="_panel _breakdown">
            <table>
              <thead>
                <tr>
                  <th>Category</th>
                  <th>Description</th>
                  <th class="_right">Low</th>
                  <th class="_right">High</th>
                </tr>
              </thead>
              <tbody id="ce_breakdown">
                <tr>
                  <td colspan="4" class="_muted" style="text-align:center;padding:18px">
                    Run a calculation to see details.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="_disclaimer">
            <strong>Important:</strong> Planning-level estimate only (not a bid). Final costs depend on site, engineering, and trade bids.
          </div>
        </div>
      </div>
    </div>

    <!-- Sticky bar -->
    <div class="_stickybar" id="icdce_sticky" role="region" aria-label="Quick actions">
      <button class="_btn" type="button" onclick="document.getElementById('ce_calcBtn')?.click()">Calculate</button>
      <button class="_btn _good" type="button" onclick="document.getElementById('ce_printBtn')?.click()" id="icdce_export_quick">
        Export PDF
      </button>
    </div>

    <!-- Paywall Modal -->
    <div id="icdce_paywall" class="_modalBackdrop" aria-hidden="true">
      <div class="_modal" role="dialog" aria-modal="true" aria-labelledby="pw_title">
        <h3 id="pw_title">Export PDF</h3>
        <p>Exporting a formatted, two-page PDF is a paid feature. Complete checkout and you‚Äôll be returned here automatically.</p>
        <div class="_row _actions-mobile">
          <button id="pw_payBtn" class="_btn _good" type="button">Go to Checkout</button>
          <button id="pw_closeBtn" class="_btn _secondary" type="button">Close</button>
        </div>
        <hr style="border:none;border-top:1px solid #e5e7eb;margin:14px 0;">
        <p style="margin-bottom:6px;">Already paid? Enter your access code or use a paid return link.</p>
        <div class="_codeRow _inline _inline-stack">
          <input id="pw_code" class="_input" type="text" placeholder="Access code (optional)" />
          <button id="pw_apply" class="_btn" type="button">Apply Code</button>
        </div>
        <div id="pw_msg" class="_hint" style="margin-top:8px;"></div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="./icdce.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var STORE_KEY = 'icdce_paid_test1d';
      try {
        var unlocked = (localStorage.getItem(STORE_KEY) === 'yes');
        if (unlocked) {
          var toast = document.getElementById('icdce_unlocked');
          if (toast) {
            toast.classList.add('_show');
            setTimeout(function(){ toast.classList.remove('_show'); }, 4200);
          }
          var quick = document.getElementById('icdce_export_quick');
          if (quick) {
            quick.classList.add('_unlocked');
            setTimeout(function(){ quick.classList.remove('_unlocked'); }, 5000);
          }
          var sticky = document.getElementById('icdce_sticky');
          if (sticky && sticky.scrollIntoView) {
            sticky.scrollIntoView({ behavior: 'smooth', block: 'end' });
          }
        }
      } catch (e) { /* ignore */ }
    });
  </script>

  <noscript>Please enable JavaScript to use the ICD Cost Estimator.</noscript>
</body>
</html>
